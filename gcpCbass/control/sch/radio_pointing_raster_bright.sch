(Time lststart, Time lststop)
# Cycle through list of radio sources taking a scan on each

import ~cbass/gcpCbass/control/sch/schedlib.sch

# Define source list, with an lst for each one.  This list is
# created by rad_set.m in order to maximize sky coverage.

group Source {
  Source name,    # source name
  Time  lst,      # lst to observe source
  Double flux     # source flux (in Jy)
}

# using only sources which are brighter than 10Jy


init_obs("Beginning schedule: radio_pointing_raster_bright.sch")

listof Source sources = {
{J0319+415, 0.00, 23.30},
{    CasA, 0.12, 670.00},
{    CasA, 0.24, 670.00},
{    CasA, 0.36, 670.00},
{J0359+509, 0.48, 10.10},
{    CygA, 0.60, 365.00},
{J0359+509, 0.72, 10.10},
{    TauA, 0.84, 615.00},
{J0319+415, 0.96, 23.30},
{J0319+415, 1.08, 23.30},
{J0319+415, 1.20, 23.30},
{    TauA, 1.32, 615.00},
{    TauA, 1.44, 615.00},
{    CasA, 1.56, 670.00},
{J0319+415, 1.68, 23.30},
{J0319+415, 1.80, 23.30},
{J0319+415, 1.92, 23.30},
{J0319+415, 2.04, 23.30},
{J0359+509, 2.16, 10.10},
{    CasA, 2.28, 670.00},
{J0319+415, 2.40, 23.30},
{J0359+509, 2.52, 10.10},
{    CasA, 2.64, 670.00},
{    TauA, 2.76, 615.00},
{    CasA, 2.88, 670.00},
{J0319+415, 3.00, 23.30},
{J0319+415, 3.12, 23.30},
{J0359+509, 3.24, 10.10},
{J0359+509, 3.36, 10.10},
{J0319+415, 3.48, 23.30},
{J0359+509, 3.60, 10.10},
{J0359+509, 3.72, 10.10},
{J0319+415, 3.84, 23.30},
{J0359+509, 3.96, 10.10},
{    CasA, 4.08, 670.00},
{J0319+415, 4.20, 23.30},
{J0319+415, 4.32, 23.30},
{J0359+509, 4.44, 10.10},
{    CasA, 4.56, 670.00},
{    TauA, 4.68, 615.00},
{J0319+415, 4.80, 23.30},
{J0359+509, 4.92, 10.10},
{    TauA, 5.04, 615.00},
{J0319+415, 5.16, 23.30},
{    CasA, 5.28, 670.00},
{    TauA, 5.40, 615.00},
{J0359+509, 5.52, 10.10},
{J0319+415, 5.64, 23.30},
{J0319+415, 5.76, 23.30},
{    CasA, 5.88, 670.00},
{J0319+415, 6.00, 23.30},
{    TauA, 6.12, 615.00},
{J0319+415, 6.24, 23.30},
{    TauA, 6.36, 615.00},
{J0359+509, 6.48, 10.10},
{J0319+415, 6.60, 23.30},
{J0319+415, 6.72, 23.30},
{J0319+415, 6.84, 23.30},
{J0359+509, 6.96, 10.10},
{J0319+415, 7.08, 23.30},
{J0359+509, 7.20, 10.10},
{J0319+415, 7.32, 23.30},
{    CasA, 7.44, 670.00},
{J0359+509, 7.56, 10.10},
{    TauA, 7.68, 615.00},
{    CasA, 7.80, 670.00},
{J1229+020, 7.92, 30.00},
{  VirgoA, 8.04, 70.00},
{  VirgoA, 8.16, 70.00},
{J1229+020, 8.28, 30.00},
{J1229+020, 8.40, 30.00},
{J0319+415, 8.52, 23.30},
{    TauA, 8.64, 615.00},
{    TauA, 8.76, 615.00},
{    TauA, 8.88, 615.00},
{J1256-057, 9.00, 11.20},
{J0319+415, 9.12, 23.30},
{  VirgoA, 9.24, 70.00},
{  VirgoA, 9.36, 70.00},
{J0319+415, 9.48, 23.30},
{J0319+415, 9.60, 23.30},
{J0319+415, 9.72, 23.30},
{J0319+415, 9.84, 23.30},
{    TauA, 9.96, 615.00},
{J1256-057, 10.08, 11.20},
{    TauA, 10.20, 615.00},
{J1229+020, 10.32, 30.00},
{J0359+509, 10.44, 10.10},
{J0359+509, 10.56, 10.10},
{J1229+020, 10.68, 30.00},
{J0359+509, 10.80, 10.10},
{J1256-057, 10.92, 11.20},
{J1229+020, 11.04, 30.00},
{  VirgoA, 11.16, 70.00},
{    TauA, 11.28, 615.00},
{J0359+509, 11.40, 10.10},
{J0359+509, 11.52, 10.10},
{J1229+020, 11.64, 30.00},
{  VirgoA, 11.76, 70.00},
{J1256-057, 11.88, 11.20},
{J1256-057, 12.00, 11.20},
{J1256-057, 12.12, 11.20},
{  VirgoA, 12.24, 70.00},
{J1256-057, 12.36, 11.20},
{  VirgoA, 12.48, 70.00},
{  VirgoA, 12.60, 70.00},
{J1256-057, 12.72, 11.20},
{J1256-057, 12.84, 11.20},
{J1229+020, 12.96, 30.00},
{J1229+020, 13.08, 30.00},
{    CygA, 13.20, 365.00},
{J1229+020, 13.32, 30.00},
{  VirgoA, 13.44, 70.00},
{J1256-057, 13.56, 11.20},
{J1229+020, 13.68, 30.00},
{J1229+020, 13.80, 30.00},
{J1229+020, 13.92, 30.00},
{    CygA, 14.04, 365.00},
{    CygA, 14.16, 365.00},
{  VirgoA, 14.28, 70.00},
{J1229+020, 14.40, 30.00},
{  VirgoA, 14.52, 70.00},
{J1229+020, 14.64, 30.00},
{    CygA, 14.76, 365.00},
{    CasA, 14.88, 670.00},
{    CasA, 15.00, 670.00},
{    CasA, 15.12, 670.00},
{J1256-057, 15.24, 11.20},
{  VirgoA, 15.36, 70.00},
{  VirgoA, 15.48, 70.00},
{    CasA, 15.60, 670.00},
{J1256-057, 15.72, 11.20},
{J1229+020, 15.84, 30.00},
{    CygA, 15.96, 365.00},
{J1229+020, 16.08, 30.00},
{J1229+020, 16.20, 30.00},
{J1256-057, 16.32, 11.20},
{J1229+020, 16.44, 30.00},
{J1229+020, 16.56, 30.00},
{J1256-057, 16.68, 11.20},
{J1229+020, 16.80, 30.00},
{    CygA, 16.92, 365.00},
{J1256-057, 17.04, 11.20},
{    CasA, 17.16, 670.00},
{  VirgoA, 17.28, 70.00},
{    CygA, 17.40, 365.00},
{  VirgoA, 17.52, 70.00},
{    CygA, 17.64, 365.00},
{    CygA, 17.76, 365.00},
{    CasA, 17.88, 670.00},
{    CasA, 18.00, 670.00},
{    CasA, 18.12, 670.00},
{    CygA, 18.24, 365.00},
{    CygA, 18.36, 365.00},
{    CygA, 18.48, 365.00},
{    CasA, 18.60, 670.00},
{    CygA, 18.72, 365.00},
{    CasA, 18.84, 670.00},
{    CygA, 18.96, 365.00},
{    CygA, 19.08, 365.00},
{    CasA, 19.20, 670.00},
{    CygA, 19.32, 365.00},
{    CygA, 19.44, 365.00},
{    CasA, 19.56, 670.00},
{    CygA, 19.68, 365.00},
{    CasA, 19.80, 670.00},
{    CasA, 19.92, 670.00},
{    CasA, 20.04, 670.00},
{    CasA, 20.16, 670.00},
{    CasA, 20.28, 670.00},
{    CasA, 20.40, 670.00},
{J0359+509, 20.52, 10.10},
{    CygA, 20.64, 365.00},
{    CygA, 20.76, 365.00},
{    CasA, 20.88, 670.00},
{J0359+509, 21.00, 10.10},
{J0319+415, 21.12, 23.30},
{J0359+509, 21.24, 10.10},
{J0359+509, 21.36, 10.10},
{    CygA, 21.48, 365.00},
{J0319+415, 21.60, 23.30},
{J0319+415, 21.72, 23.30},
{J0319+415, 21.84, 23.30},
{    CasA, 21.96, 670.00},
{J0319+415, 22.08, 23.30},
{    CygA, 22.20, 365.00},
{    CasA, 22.32, 670.00},
{J0359+509, 22.44, 10.10},
{    CygA, 22.56, 365.00},
{J0359+509, 22.68, 10.10},
{    CygA, 22.80, 365.00},
{    CygA, 22.92, 365.00},
{J0319+415, 23.04, 23.30},
{J0359+509, 23.16, 10.10},
{J0319+415, 23.28, 23.30},
{    CasA, 23.40, 670.00},
{    CasA, 23.52, 670.00},
{J0319+415, 23.64, 23.30},
{J0359+509, 23.76, 10.10},
{J0319+415, 23.88, 23.30}
}

# Set archiving to the correct mode
mark remove, all

#-----------------------------------------------------------------------
# Main loop -- track the next source,do a raster, move on
#-----------------------------------------------------------------------

log "Waiting for lststart..."
until $after($lststart,lst) 

  # Go through list
  foreach(Source source) $sources {

    # Break if past lststop
    if $time(lst)>$lststop {
       log "lststop reached"
       break
    }   

    # Skip sources whose lst has passed
    if $time(lst)>$source.lst  {
       log "too late for source",$source.name
    }

    # Do a cross on next available source
    if $time(lst)<$source.lst {
      # Track Source
      track $source.name
      until $acquired(source)
      until $after($source.lst,lst) # make sure we're not early
      log "Doing scan on ",$source.name

      # Do scan
      mark add, f7	
      scan point_10d_0.5step
      #until $acquired(scan)
      until $elapsed >7m
      mark remove, f7

      zeroScanOffsets   	# zero offsets
    }
  }

terminate("Finished schedule: radio_pointing_raster_bright.sch")

