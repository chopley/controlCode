(Time lststart, Time lststop)
# Cycle through list of radio sources taking a cross-scan on each

# sources must be really bright

import ~cbass/gcpCbass/control/sch/schedlib.sch

# Define source list, with an lst for each one.  This list is
# created by rad_set.m in order to maximize sky coverage.

group Source {
  Source name,    # source name
  Time  lst,      # lst to observe source
  Double flux     # source flux (in Jy)
}

listof Source sources = {
{casa, 0.00, 23.30},
{    CasA, 0.06, 670.00},
{    TauA, 0.12, 615.00},
{casa, 0.18, 23.30},
{    CasA, 0.24, 670.00},
{    TauA, 0.30, 615.00},
{    CasA, 0.36, 670.00},
{    TauA, 0.42, 615.00},
{    CygA, 0.48, 365.00},
{    CasA, 0.54, 670.00},
{    CygA, 0.60, 365.00},
{casa, 0.66, 23.30},
{    CygA, 0.72, 365.00},
{    CygA, 0.78, 365.00},
{    CygA, 0.84, 365.00},
{    CygA, 0.90, 365.00},
{    CasA, 0.96, 670.00},
{    CasA, 1.02, 670.00},
{    CygA, 1.08, 365.00},
{    CygA, 1.14, 365.00},
{    CasA, 1.20, 670.00},
{    CygA, 1.26, 365.00},
{casa, 1.32, 23.30},
{    TauA, 1.38, 615.00},
{    TauA, 1.44, 615.00},
{    CasA, 1.50, 670.00},
{casa, 1.56, 23.30},
{    CygA, 1.62, 365.00},
{    TauA, 1.68, 615.00},
{casa, 1.74, 23.30},
{    CygA, 1.80, 365.00},
{    TauA, 1.86, 615.00},
{cyga, 1.92, 23.30},
{    CygA, 1.98, 365.00},
{    CasA, 2.04, 670.00},
{    CygA, 2.10, 365.00},
{    CygA, 2.16, 365.00},
{cyga, 2.22, 23.30},
{    TauA, 2.28, 615.00},
{cyga, 2.34, 23.30},
{    CygA, 2.40, 365.00},
{    CasA, 2.46, 670.00},
{    CygA, 2.52, 365.00},
{    CygA, 2.58, 365.00},
{casa, 2.64, 23.30},
{    TauA, 2.70, 615.00},
{    TauA, 2.76, 615.00},
{    CygA, 2.82, 365.00},
{    CasA, 2.88, 670.00},
{    CasA, 2.94, 670.00},
{casa, 3.00, 23.30},
{    TauA, 3.06, 615.00},
{casa, 3.12, 23.30},
{    TauA, 3.18, 615.00},
{casa, 3.24, 23.30},
{    TauA, 3.30, 615.00},
{    TauA, 3.36, 615.00},
{    TauA, 3.42, 615.00},
{casa, 3.48, 23.30},
{    TauA, 3.54, 615.00},
{    CasA, 3.60, 670.00},
{    TauA, 3.66, 615.00},
{    TauA, 3.72, 615.00},
{    TauA, 3.78, 615.00},
{taua, 3.84, 23.30},
{taua, 3.90, 23.30},
{taua, 3.96, 23.30},
{    TauA, 4.02, 615.00},
{    TauA, 4.08, 615.00},
{    TauA, 4.14, 615.00},
{taua, 4.20, 23.30},
{taua, 4.26, 23.30},
{taua, 4.32, 23.30},
{taua, 4.38, 23.30},
{    CasA, 4.44, 670.00},
{    CasA, 4.50, 670.00},
{    CasA, 4.56, 670.00},
{taua, 4.62, 23.30},
{    CasA, 4.68, 670.00},
{taua, 4.74, 23.30},
{    TauA, 4.80, 615.00},
{    TauA, 4.86, 615.00},
{    CasA, 4.92, 670.00},
{    CasA, 4.98, 670.00},
{    CasA, 5.04, 670.00},
{taua, 5.10, 23.30},
{taua, 5.16, 23.30},
{    TauA, 5.22, 615.00},
{taua, 5.28, 23.30},
{taua, 5.34, 23.30},
{    CasA, 5.40, 670.00},
{    CasA, 5.46, 670.00},
{    CasA, 5.52, 670.00},
{taua, 5.58, 23.30},
{    TauA, 5.64, 615.00},
{taua, 5.70, 23.30},
{    CasA, 5.76, 670.00},
{    TauA, 5.82, 615.00},
{    CasA, 5.88, 670.00},
{    CasA, 5.94, 670.00},
{taua, 6.00, 23.30},
{taua, 6.06, 23.30},
{    TauA, 6.12, 615.00},
{taua, 6.18, 23.30},
{    CasA, 6.24, 670.00},
{    TauA, 6.30, 615.00},
{    TauA, 6.36, 615.00},
{taua, 6.42, 23.30},
{taua, 6.48, 23.30},
{taua, 6.54, 23.30},
{    CasA, 6.60, 670.00},
{    TauA, 6.66, 615.00},
{    TauA, 6.72, 615.00},
{    CasA, 6.78, 670.00},
{    TauA, 6.84, 615.00},
{    TauA, 6.90, 615.00},
{    TauA, 6.96, 615.00},
{taua, 7.02, 23.30},
{    TauA, 7.08, 615.00},
{    CasA, 7.14, 670.00},
{    CasA, 7.20, 670.00},
{  VirgoA, 7.26, 70.00},
{    CasA, 7.32, 670.00},
{  VirgoA, 7.38, 70.00},
{  VirgoA, 7.44, 70.00},
{  VirgoA, 7.50, 70.00},
{  VirgoA, 7.56, 70.00},
{taua, 7.62, 23.30},
{    TauA, 7.68, 615.00},
{taua, 7.74, 23.30},
{    TauA, 7.80, 615.00},
{    CasA, 7.86, 670.00},
{virgoa, 7.92, 30.00},
{  VirgoA, 7.98, 70.00},
{virgoa, 8.04, 30.00},
{  VirgoA, 8.10, 70.00},
{    TauA, 8.16, 615.00},
{virgoa, 8.22, 30.00},
{taua, 8.28, 23.30},
{  VirgoA, 8.34, 70.00},
{  VirgoA, 8.40, 70.00},
{  VirgoA, 8.46, 70.00},
{taua, 8.52, 23.30},
{taua, 8.58, 23.30},
{  VirgoA, 8.64, 70.00},
{virgoa, 8.70, 30.00},
{taua, 8.76, 23.30},
{taua, 8.82, 23.30},
{  VirgoA, 8.88, 70.00},
{virgoa, 8.94, 30.00},
{virgoa, 9.00, 30.00},
{taua, 9.06, 23.30},
{    TauA, 9.12, 615.00},
{taua, 9.18, 23.30},
{    TauA, 9.24, 615.00},
{  VirgoA, 9.30, 70.00},
{  VirgoA, 9.36, 70.00},
{virgoa, 9.42, 30.00},
{    TauA, 9.48, 615.00},
{virgoa, 9.54, 30.00},
{virgoa, 9.60, 30.00},
{taua, 9.66, 23.30},
{taua, 9.72, 23.30},
{    TauA, 9.78, 615.00},
{  VirgoA, 9.84, 70.00},
{virgoa, 9.90, 30.00},
{  VirgoA, 9.96, 70.00},
{    TauA, 10.02, 615.00},
{    TauA, 10.08, 615.00},
{  VirgoA, 10.14, 70.00},
{  VirgoA, 10.20, 70.00},
{    TauA, 10.26, 615.00},
{  VirgoA, 10.32, 70.00},
{virgoa, 10.38, 30.00},
{virgoa, 10.44, 30.00},
{  VirgoA, 10.50, 70.00},
{  VirgoA, 10.56, 70.00},
{virgoa, 10.62, 30.00},
{  VirgoA, 10.68, 70.00},
{  VirgoA, 10.74, 70.00},
{  VirgoA, 10.80, 70.00},
{    TauA, 10.86, 615.00},
{  VirgoA, 10.92, 70.00},
{    TauA, 10.98, 615.00},
{    TauA, 11.04, 615.00},
{    TauA, 11.10, 615.00},
{    TauA, 11.16, 615.00},
{virgoa, 11.22, 30.00},
{  VirgoA, 11.28, 70.00},
{  VirgoA, 11.34, 70.00},
{  VirgoA, 11.46, 70.00},
{virgoa, 11.52, 30.00},
{  VirgoA, 11.58, 70.00},
{  VirgoA, 11.64, 70.00},
{  VirgoA, 11.70, 70.00},
{virgoa, 11.76, 30.00},
{  VirgoA, 11.82, 70.00},
{virgoa, 11.88, 30.00},
{virgoa, 11.94, 30.00},
{virgoa, 12.00, 30.00},
{virgoa, 12.06, 30.00},
{  VirgoA, 12.12, 70.00},
{  VirgoA, 12.18, 70.00},
{  VirgoA, 12.24, 70.00},
{  VirgoA, 12.30, 70.00},
{virgoa, 12.36, 30.00},
{  VirgoA, 12.42, 70.00},
{  VirgoA, 12.48, 70.00},
{  VirgoA, 12.54, 70.00},
{  VirgoA, 12.60, 70.00},
{  VirgoA, 12.66, 70.00},
{  VirgoA, 12.72, 70.00},
{  VirgoA, 12.78, 70.00},
{virgoa, 12.84, 30.00},
{virgoa, 12.90, 30.00},
{virgoa, 12.96, 30.00},
{virgoa, 13.02, 30.00},
{virgoa, 13.08, 30.00},
{virgoa, 13.14, 30.00},
{virgoa, 13.20, 30.00},
{virgoa, 13.26, 30.00},
{virgoa, 13.32, 30.00},
{virgoa, 13.38, 30.00},
{  VirgoA, 13.44, 70.00},
{  VirgoA, 13.50, 70.00},
{    CygA, 13.56, 365.00},
{virgoa, 13.62, 30.00},
{    CygA, 13.68, 365.00},
{  VirgoA, 13.74, 70.00},
{    CygA, 13.80, 365.00},
{virgoa, 13.86, 30.00},
{virgoa, 13.92, 30.00},
{    CygA, 13.98, 365.00},
{  VirgoA, 14.04, 70.00},
{  VirgoA, 14.10, 70.00},
{  VirgoA, 14.16, 70.00},
{  VirgoA, 14.22, 70.00},
{virgoa, 14.28, 30.00},
{virgoa, 14.34, 30.00},
{    CygA, 14.40, 365.00},
{    CygA, 14.46, 365.00},
{    CygA, 14.52, 365.00},
{  VirgoA, 14.58, 70.00},
{virgoa, 14.64, 30.00},
{    CygA, 14.70, 365.00},
{  VirgoA, 14.76, 70.00},
{    CygA, 14.82, 365.00},
{virgoa, 14.88, 30.00},
{virgoa, 14.94, 30.00},
{    CasA, 15.00, 670.00},
{virgoa, 15.06, 30.00},
{  VirgoA, 15.12, 70.00},
{    CasA, 15.18, 670.00},
{    CygA, 15.24, 365.00},
{  VirgoA, 15.30, 70.00},
{    CygA, 15.36, 365.00},
{  VirgoA, 15.42, 70.00},
{    CasA, 15.48, 670.00},
{virgoa, 15.54, 30.00},
{virgoa, 15.60, 30.00},
{virgoa, 15.66, 30.00},
{    CasA, 15.72, 670.00},
{virgoa, 15.78, 30.00},
{virgoa, 15.84, 30.00},
{  VirgoA, 15.90, 70.00},
{    CasA, 15.96, 670.00},
{    CasA, 16.02, 670.00},
{    CasA, 16.08, 670.00},
{casa, 16.14, 30.00},
{    CygA, 16.20, 365.00},
{casa, 16.26, 30.00},
{    CygA, 16.32, 365.00},
{    CasA, 16.38, 670.00},
{    CasA, 16.44, 670.00},
{casa, 16.50, 30.00},
{casa, 16.56, 30.00},
{casa, 16.62, 30.00},
{casa, 16.68, 30.00},
{casa, 16.74, 30.00},
{  VirgoA, 16.80, 70.00},
{  VirgoA, 16.86, 70.00},
{    CygA, 16.92, 365.00},
{    CasA, 16.98, 670.00},
{    CygA, 17.04, 365.00},
{    CygA, 17.10, 365.00},
{    CygA, 17.16, 365.00},
{  VirgoA, 17.22, 70.00},
{casa, 17.28, 30.00},
{    CasA, 17.34, 670.00},
{  VirgoA, 17.40, 70.00},
{    CasA, 17.46, 670.00},
{    CasA, 17.52, 670.00},
{  VirgoA, 17.58, 70.00},
{    CygA, 17.64, 365.00},
{    CygA, 17.70, 365.00},
{    CasA, 17.76, 670.00},
{    CasA, 17.82, 670.00},
{    CygA, 17.88, 365.00},
{    CygA, 17.94, 365.00},
{    CasA, 18.00, 670.00},
{    CasA, 18.06, 670.00},
{    CygA, 18.12, 365.00},
{    CygA, 18.18, 365.00},
{    CygA, 18.24, 365.00},
{    CygA, 18.30, 365.00},
{    CygA, 18.36, 365.00},
{    CygA, 18.42, 365.00},
{    CygA, 18.48, 365.00},
{    CygA, 18.54, 365.00},
{    CygA, 18.60, 365.00},
{    CasA, 18.66, 670.00},
{    CygA, 18.72, 365.00},
{    CygA, 18.78, 365.00},
{    CygA, 18.84, 365.00},
{    CygA, 18.90, 365.00},
{    CygA, 18.96, 365.00},
{    CygA, 19.02, 365.00},
{    CasA, 19.08, 670.00},
{    CygA, 19.14, 365.00},
{    CasA, 19.20, 670.00},
{    CygA, 19.26, 365.00},
{    CasA, 19.32, 670.00},
{    CygA, 19.38, 365.00},
{    CygA, 19.44, 365.00},
{    CasA, 19.50, 670.00},
{    CygA, 19.56, 365.00},
{    CygA, 19.62, 365.00},
{    CygA, 19.68, 365.00},
{    CasA, 19.74, 670.00},
{    CygA, 19.80, 365.00},
{    CasA, 19.86, 670.00},
{    CygA, 19.92, 365.00},
{    CasA, 19.98, 670.00},
{    CasA, 20.04, 670.00},
{    CygA, 20.10, 365.00},
{    CygA, 20.16, 365.00},
{    CygA, 20.22, 365.00},
{    CasA, 20.28, 670.00},
{    CasA, 20.34, 670.00},
{    CasA, 20.40, 670.00},
{    CasA, 20.46, 670.00},
{    CygA, 20.52, 365.00},
{cyga, 20.58, 23.30},
{    CygA, 20.64, 365.00},
{    CasA, 20.70, 670.00},
{    CasA, 20.76, 670.00},
{cyga, 20.82, 23.30},
{    CasA, 20.88, 670.00},
{    CygA, 20.94, 365.00},
{    CasA, 21.00, 670.00},
{cyga, 21.06, 23.30},
{cyga, 21.12, 23.30},
{    CasA, 21.18, 670.00},
{cyga, 21.24, 23.30},
{    CasA, 21.30, 670.00},
{    CygA, 21.36, 365.00},
{    CygA, 21.42, 365.00},
{    CygA, 21.48, 365.00},
{    CygA, 21.54, 365.00},
{    CygA, 21.60, 365.00},
{    CygA, 21.66, 365.00},
{    CasA, 21.72, 670.00},
{    CasA, 21.78, 670.00},
{    CasA, 21.84, 670.00},
{cyga, 21.90, 23.30},
{cyga, 21.96, 23.30},
{    CygA, 22.02, 365.00},
{cyga, 22.08, 23.30},
{    CasA, 22.14, 670.00},
{cyga, 22.20, 23.30},
{    CygA, 22.26, 365.00},
{    CasA, 22.32, 670.00},
{cyga, 22.38, 23.30},
{    CasA, 22.44, 670.00},
{    CygA, 22.50, 365.00},
{    CygA, 22.56, 365.00},
{    CasA, 22.62, 670.00},
{cyga, 22.68, 23.30},
{    CygA, 22.74, 365.00},
{    CygA, 22.80, 365.00},
{    CygA, 22.86, 365.00},
{cyga, 22.92, 23.30},
{cyga, 22.98, 23.30},
{cyga, 23.04, 23.30},
{    CygA, 23.10, 365.00},
{    CygA, 23.16, 365.00},
{    CasA, 23.22, 670.00},
{    CasA, 23.28, 670.00},
{    CygA, 23.34, 365.00},
{cyga, 23.40, 23.30},
{    CygA, 23.46, 365.00},
{cyga, 23.52, 23.30},
{cyga, 23.58, 23.30},
{cyga, 23.64, 23.30},
{cyga, 23.70, 23.30},
{    CasA, 23.76, 670.00},
{    TauA, 23.82, 615.00},
{cyga, 23.88, 23.30},
{    CygA, 23.94, 365.00}
}


# start observation
init_obs("Beginning schedule: radio_pointing.sch")

# do a sky dip
#do_sky_dip

# Set archiving to the correct mode
mark remove, all

#-----------------------------------------------------------------------
# Main loop -- track the next source,do a raster, move on
#-----------------------------------------------------------------------

log "Waiting for lststart..."
until $after($lststart,lst) 

  # Go through list
  foreach(Source source) $sources {

    # Break if past lststop
    if $time(lst)>$lststop {
       log "lststop reached"
       break
    }   

    # Skip sources whose lst has passed
    if $time(lst)>$source.lst  {
       log "too late for source",$source.name
    }

    # Do a cross on next available source
    if $time(lst)<$source.lst {

      if ($elevation($source.name) >= 27) {

      # Track Source
      until $after($source.lst,lst) # make sure we're not early
      log "Doing scan on ",$source.name

      # Do scan
      do_point_scan($source.name)


      zeroScanOffsets   	# zero offsets
    } #elevation requirement

    }
  }

# do a sky dip
#do_sky_dip

terminate("Finished schedule: radio_pointing.sch")

