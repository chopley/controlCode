(Time lststart, Time lststop)
# Cycle through list of radio sources taking a cross-scan on each

# sources must be really bright

import ~cbassuser/cbass/gcpCbass/control/sch/schedlibSouth.sch

#get the scan catalogue
scan_catalog ~cbassuser/cbass/gcpCbass/control/scan/cbass_scan.cat

# Define source list, with an lst for each one.  This list is
# created by rad_set_south.m in order to maximize sky coverage.
# Command used in matlab in cbass_analysis: rad_set_south(5.0,0.5,24.0,1.0,'cbass_south_sources.cat')

group Source {
  Source name,    # source name
  Time  lst,      # lst to observe source
  Double flux     # source flux (in Jy)
}

listof Source sources = {
{ NGC1316, 0.00, 60.00},
{PMNJ1924, 0.05, 10.00},
{ NGC1316, 0.10, 60.00},
{PMNJ1924, 0.15, 10.00},
{ NGC1316, 0.20, 60.00},
{ NGC1316, 0.25, 60.00},
{ NGC1316, 0.30, 60.00},
{ NGC1316, 0.35, 60.00},
{ NGC1316, 0.40, 60.00},
{ NGC1316, 0.45, 60.00},
{ NGC1316, 0.50, 60.00},
{ NGC1316, 0.55, 60.00},
{ NGC1316, 0.60, 60.00},
{ NGC1316, 0.65, 60.00},
{ NGC1316, 0.70, 60.00},
{ NGC1316, 0.75, 60.00},
{ NGC1316, 0.80, 60.00},
{ NGC1316, 0.85, 60.00},
{ NGC1316, 0.90, 60.00},
{ NGC1316, 0.95, 60.00},
{ NGC1316, 1.00, 60.00},
{ NGC1316, 1.05, 60.00},
{ NGC1316, 1.10, 60.00},
{ NGC1316, 1.15, 60.00},
{ NGC1316, 1.20, 60.00},
{ NGC1316, 1.25, 60.00},
{     M42, 1.30, 100.00},
{ NGC1316, 1.35, 60.00},
{     M42, 1.40, 100.00},
{ NGC1316, 1.45, 60.00},
{ NGC1316, 1.50, 60.00},
{     M42, 1.55, 100.00},
{     M42, 1.60, 100.00},
{ NGC1316, 1.65, 60.00},
{     M42, 1.70, 100.00},
{ NGC1316, 1.75, 60.00},
{     M42, 1.80, 100.00},
{     M42, 1.85, 100.00},
{ NGC1316, 1.90, 60.00},
{ NGC1316, 1.95, 60.00},
{     M42, 2.00, 100.00},
{     M42, 2.05, 100.00},
{ NGC1316, 2.10, 60.00},
{     M42, 2.15, 100.00},
{     M42, 2.20, 100.00},
{     M42, 2.25, 100.00},
{ NGC1316, 2.30, 60.00},
{ NGC1316, 2.35, 60.00},
{     M42, 2.40, 100.00},
{     M42, 2.45, 100.00},
{ NGC1316, 2.50, 60.00},
{ NGC1316, 2.55, 60.00},
{ NGC1316, 2.60, 60.00},
{     M42, 2.65, 100.00},
{ NGC1316, 2.70, 60.00},
{     M42, 2.75, 100.00},
{    TauA, 2.80, 100.00},
{    TauA, 2.85, 100.00},
{    TauA, 2.90, 100.00},
{ NGC1316, 2.95, 60.00},
{    TauA, 3.00, 100.00},
{ NGC1316, 3.05, 60.00},
{ NGC1316, 3.10, 60.00},
{ NGC1316, 3.15, 60.00},
{ NGC1316, 3.20, 60.00},
{    TauA, 3.25, 100.00},
{ NGC1316, 3.30, 60.00},
{    TauA, 3.35, 100.00},
{ NGC1316, 3.40, 60.00},
{ NGC1316, 3.45, 60.00},
{ NGC1316, 3.50, 60.00},
{ NGC1316, 3.55, 60.00},
{     M42, 3.60, 100.00},
{ NGC1316, 3.65, 60.00},
{    TauA, 3.70, 100.00},
{    TauA, 3.75, 100.00},
{ NGC1316, 3.80, 60.00},
{PMNJ0859, 3.85, 100.00},
{PMNJ0859, 3.90, 100.00},
{    TauA, 3.95, 100.00},
{ NGC1316, 4.00, 60.00},
{ NGC1316, 4.05, 60.00},
{    TauA, 4.10, 100.00},
{ NGC1316, 4.15, 60.00},
{PMNJ0859, 4.20, 100.00},
{PMNJ0859, 4.25, 100.00},
{    TauA, 4.30, 100.00},
{PMNJ0859, 4.35, 100.00},
{ NGC1316, 4.40, 60.00},
{PMNJ0859, 4.45, 100.00},
{ NGC1316, 4.50, 60.00},
{PMNJ0859, 4.55, 100.00},
{     M42, 4.60, 100.00},
{    TauA, 4.65, 100.00},
{PMNJ0859, 4.70, 100.00},
{ NGC1316, 4.75, 60.00},
{    TauA, 4.80, 100.00},
{    TauA, 4.85, 100.00},
{PMNJ0859, 4.90, 100.00},
{ NGC1316, 4.95, 60.00},
{ NGC1316, 5.00, 60.00},
{    TauA, 5.05, 100.00},
{ NGC1316, 5.10, 60.00},
{     M42, 5.15, 100.00},
{    TauA, 5.20, 100.00},
{     M42, 5.25, 100.00},
{ NGC1316, 5.30, 60.00},
{ NGC1316, 5.35, 60.00},
{PMNJ0859, 5.40, 100.00},
{PMNJ0859, 5.45, 100.00},
{PMNJ0859, 5.50, 100.00},
{ NGC1316, 5.55, 60.00},
{PMNJ0859, 5.60, 100.00},
{PMNJ1115, 5.65, 94.10},
{    TauA, 5.70, 100.00},
{PMNJ1024, 5.75, 89.20},
{ NGC1316, 5.80, 60.00},
{ NGC1316, 5.85, 60.00},
{    TauA, 5.90, 100.00},
{PMNJ1115, 5.95, 94.10},
{PMNJ1115, 6.00, 94.10},
{     M42, 6.05, 100.00},
{PMNJ1024, 6.10, 89.20},
{    TauA, 6.15, 100.00},
{ NGC1316, 6.20, 60.00},
{PMNJ1024, 6.25, 89.20},
{    TauA, 6.30, 100.00},
{PMNJ1115, 6.35, 94.10},
{ NGC1316, 6.40, 60.00},
{PMNJ0859, 6.45, 100.00},
{    TauA, 6.50, 100.00},
{PMNJ1024, 6.55, 89.20},
{PMNJ0859, 6.60, 100.00},
{ NGC1316, 6.65, 60.00},
{ NGC1316, 6.70, 60.00},
{     M42, 6.75, 100.00},
{PMNJ1024, 6.80, 89.20},
{PMNJ0859, 6.85, 100.00},
{PMNJ0859, 6.90, 100.00},
{ NGC1316, 6.95, 60.00},
{    TauA, 7.00, 100.00},
{    TauA, 7.05, 100.00},
{ NGC1316, 7.10, 60.00},
{ NGC1316, 7.15, 60.00},
{ NGC1316, 7.20, 60.00},
{PMNJ1115, 7.25, 94.10},
{PMNJ1024, 7.30, 89.20},
{PMNJ0859, 7.35, 100.00},
{PMNJ0859, 7.40, 100.00},
{ NGC1316, 7.45, 60.00},
{ NGC1316, 7.50, 60.00},
{PMNJ1024, 7.55, 89.20},
{PMNJ1024, 7.60, 89.20},
{PMNJ0859, 7.65, 100.00},
{     M42, 7.70, 100.00},
{ NGC1316, 7.75, 60.00},
{    TauA, 7.80, 100.00},
{PMNJ0859, 7.85, 100.00},
{     M42, 7.90, 100.00},
{PMNJ1115, 7.95, 94.10},
{     M42, 8.00, 100.00},
{     M42, 8.05, 100.00},
{PMNJ1024, 8.10, 89.20},
{    TauA, 8.15, 100.00},
{PMNJ0859, 8.20, 100.00},
{PMNJ1024, 8.25, 89.20},
{PMNJ0859, 8.30, 100.00},
{ NGC1316, 8.35, 60.00},
{PMNJ1115, 8.40, 94.10},
{PMNJ1024, 8.45, 89.20},
{PMNJ1325, 8.50, 66.00},
{PMNJ0859, 8.55, 100.00},
{J1229+020, 8.60, 10.00},
{PMNJ1024, 8.65, 89.20},
{J1229+020, 8.70, 10.00},
{PMNJ1325, 8.75, 66.00},
{PMNJ1115, 8.80, 94.10},
{J1229+020, 8.85, 10.00},
{PMNJ0859, 8.90, 100.00},
{J1230+123, 8.95, 10.00},
{J1229+020, 9.00, 10.00},
{PMNJ0859, 9.05, 100.00},
{J1230+123, 9.10, 10.00},
{PMNJ0859, 9.15, 100.00},
{PMNJ0859, 9.20, 100.00},
{PMNJ1024, 9.25, 89.20},
{PMNJ1325, 9.30, 66.00},
{PMNJ1325, 9.35, 66.00},
{PMNJ1024, 9.40, 89.20},
{PMNJ1115, 9.45, 94.10},
{PMNJ1115, 9.50, 94.10},
{PMNJ1325, 9.55, 66.00},
{     M42, 9.60, 100.00},
{PMNJ1115, 9.65, 94.10},
{     M42, 9.70, 100.00},
{J1230+123, 9.75, 10.00},
{PMNJ1024, 9.80, 89.20},
{     M42, 9.85, 100.00},
{PMNJ0859, 9.90, 100.00},
{PMNJ1115, 9.95, 94.10},
{J1229+020, 10.00, 10.00},
{J1230+123, 10.05, 10.00},
{PMNJ1115, 10.10, 94.10},
{J1229+020, 10.15, 10.00},
{PMNJ1115, 10.20, 94.10},
{J1229+020, 10.25, 10.00},
{PMNJ0859, 10.30, 100.00},
{PMNJ1115, 10.35, 94.10},
{PMNJ1325, 10.40, 66.00},
{J1229+020, 10.45, 10.00},
{J1230+123, 10.50, 10.00},
{J1229+020, 10.55, 10.00},
{J1229+020, 10.60, 10.00},
{PMNJ1325, 10.65, 66.00},
{PMNJ1115, 10.70, 94.10},
{PMNJ0859, 10.75, 100.00},
{PMNJ1325, 10.80, 66.00},
{J1229+020, 10.85, 10.00},
{J1229+020, 10.90, 10.00},
{PMNJ1024, 10.95, 89.20},
{PMNJ1115, 11.00, 94.10},
{PMNJ1024, 11.05, 89.20},
{PMNJ1325, 11.10, 66.00},
{J1229+020, 11.15, 10.00},
{J1229+020, 11.20, 10.00},
{PMNJ1024, 11.25, 89.20},
{PMNJ1325, 11.30, 66.00},
{PMNJ0859, 11.35, 100.00},
{J1229+020, 11.40, 10.00},
{PMNJ1622, 11.45, 77.30},
{J1229+020, 11.50, 10.00},
{PMNJ1622, 11.55, 77.30},
{PMNJ0859, 11.60, 100.00},
{PMNJ1325, 11.65, 66.00},
{J1230+123, 11.70, 10.00},
{PMNJ1115, 11.75, 94.10},
{J1229+020, 11.80, 10.00},
{PMNJ0859, 11.85, 100.00},
{PMNJ1115, 11.90, 94.10},
{PMNJ1115, 11.95, 94.10},
{PMNJ1325, 12.00, 66.00},
{PMNJ1115, 12.05, 94.10},
{PMNJ0859, 12.10, 100.00},
{PMNJ1115, 12.15, 94.10},
{PMNJ1024, 12.20, 89.20},
{PMNJ1024, 12.25, 89.20},
{PMNJ0859, 12.30, 100.00},
{PMNJ1115, 12.35, 94.10},
{PMNJ1115, 12.40, 94.10},
{PMNJ1622, 12.45, 77.30},
{PMNJ1325, 12.50, 66.00},
{PMNJ1024, 12.55, 89.20},
{J1230+123, 12.60, 10.00},
{PMNJ0859, 12.65, 100.00},
{J1229+020, 12.70, 10.00},
{PMNJ0859, 12.75, 100.00},
{J1230+123, 12.80, 10.00},
{PMNJ0859, 12.85, 100.00},
{PMNJ1325, 12.90, 66.00},
{J1230+123, 12.95, 10.00},
{PMNJ1325, 13.00, 66.00},
{J1229+020, 13.05, 10.00},
{PMNJ1325, 13.10, 66.00},
{J1229+020, 13.15, 10.00},
{PMNJ1325, 13.20, 66.00},
{J1230+123, 13.25, 10.00},
{PMNJ1115, 13.30, 94.10},
{J1229+020, 13.35, 10.00},
{PMNJ0859, 13.40, 100.00},
{J1230+123, 13.45, 10.00},
{J1230+123, 13.50, 10.00},
{PMNJ1325, 13.55, 66.00},
{PMNJ1115, 13.60, 94.10},
{PMNJ0859, 13.65, 100.00},
{PMNJ1115, 13.70, 94.10},
{J1230+123, 13.75, 10.00},
{     M17, 13.80, 92.10},
{PMNJ1115, 13.85, 94.10},
{J1230+123, 13.90, 10.00},
{PMNJ0859, 13.95, 100.00},
{PMNJ1115, 14.00, 94.10},
{J1809-202, 14.05, 10.00},
{J1809-202, 14.10, 10.00},
{J1809-202, 14.15, 10.00},
{PMNJ1622, 14.20, 77.30},
{PMNJ1622, 14.25, 77.30},
{J1230+123, 14.30, 10.00},
{     M17, 14.35, 92.10},
{PMNJ1325, 14.40, 66.00},
{PMNJ1325, 14.45, 66.00},
{J1230+123, 14.50, 10.00},
{PMNJ1024, 14.55, 89.20},
{PMNJ1115, 14.60, 94.10},
{PMNJ1924, 14.65, 10.00},
{J1229+020, 14.70, 10.00},
{J1229+020, 14.75, 10.00},
{PMNJ1325, 14.80, 66.00},
{     M17, 14.85, 92.10},
{     M17, 14.90, 92.10},
{PMNJ1115, 14.95, 94.10},
{J1229+020, 15.00, 10.00},
{PMNJ1115, 15.05, 94.10},
{PMNJ1924, 15.10, 10.00},
{J1230+123, 15.15, 10.00},
{PMNJ1924, 15.20, 10.00},
{J1229+020, 15.25, 10.00},
{    SgrA, 15.30, 100.00},
{J1230+123, 15.35, 10.00},
{PMNJ1325, 15.40, 66.00},
{PMNJ1924, 15.45, 10.00},
{J1809-202, 15.50, 10.00},
{     M17, 15.55, 92.10},
{PMNJ1115, 15.60, 94.10},
{    SgrA, 15.65, 100.00},
{PMNJ1924, 15.70, 10.00},
{J1809-202, 15.75, 10.00},
{J1809-202, 15.80, 10.00},
{J1229+020, 15.85, 10.00},
{    SgrA, 15.90, 100.00},
{PMNJ1115, 15.95, 94.10},
{    SgrA, 16.00, 100.00},
{PMNJ1115, 16.05, 94.10},
{J1809-202, 16.10, 10.00},
{PMNJ1622, 16.15, 77.30},
{PMNJ1622, 16.20, 77.30},
{J1229+020, 16.25, 10.00},
{J1229+020, 16.30, 10.00},
{     M17, 16.35, 92.10},
{IR19207+1410, 16.40, 10.00},
{    SgrA, 16.45, 100.00},
{IR19207+1410, 16.50, 10.00},
{IR19207+1410, 16.55, 10.00},
{     M17, 16.60, 92.10},
{IR19207+1410, 16.65, 10.00},
{IR19207+1410, 16.70, 10.00},
{    SgrA, 16.75, 100.00},
{J1809-202, 16.80, 10.00},
{PMNJ1115, 16.85, 94.10},
{J1809-202, 16.90, 10.00},
{     M17, 16.95, 92.10},
{IR19207+1410, 17.00, 10.00},
{     M17, 17.05, 92.10},
{    SgrA, 17.10, 100.00},
{PMNJ1622, 17.15, 77.30},
{PMNJ1325, 17.20, 66.00},
{PMNJ1622, 17.25, 77.30},
{PMNJ1325, 17.30, 66.00},
{PMNJ1924, 17.35, 10.00},
{    SgrA, 17.40, 100.00},
{J1809-202, 17.45, 10.00},
{PMNJ1622, 17.50, 77.30},
{PMNJ1325, 17.55, 66.00},
{PMNJ1325, 17.60, 66.00},
{     M17, 17.65, 92.10},
{J1809-202, 17.70, 10.00},
{    SgrA, 17.75, 100.00},
{    SgrA, 17.80, 100.00},
{PMNJ1325, 17.85, 66.00},
{PMNJ1325, 17.90, 66.00},
{PMNJ1622, 17.95, 77.30},
{IR19207+1410, 18.00, 10.00},
{    SgrA, 18.05, 100.00},
{PMNJ1622, 18.10, 77.30},
{J1809-202, 18.15, 10.00},
{PMNJ1622, 18.20, 77.30},
{J1809-202, 18.25, 10.00},
{PMNJ1325, 18.30, 66.00},
{IR19207+1410, 18.35, 10.00},
{PMNJ1622, 18.40, 77.30},
{PMNJ1622, 18.45, 77.30},
{IR19207+1410, 18.50, 10.00},
{PMNJ1924, 18.55, 10.00},
{    SgrA, 18.60, 100.00},
{PMNJ1325, 18.65, 66.00},
{PMNJ1622, 18.70, 77.30},
{PMNJ1622, 18.75, 77.30},
{    SgrA, 18.80, 100.00},
{    SgrA, 18.85, 100.00},
{    SgrA, 18.90, 100.00},
{J1809-202, 18.95, 10.00},
{     M17, 19.00, 92.10},
{IR19207+1410, 19.05, 10.00},
{J1809-202, 19.10, 10.00},
{IR19207+1410, 19.15, 10.00},
{IR19207+1410, 19.20, 10.00},
{IR19207+1410, 19.25, 10.00},
{IR19207+1410, 19.30, 10.00},
{J1809-202, 19.35, 10.00},
{PMNJ1622, 19.40, 77.30},
{IR19207+1410, 19.45, 10.00},
{PMNJ1622, 19.50, 77.30},
{     M17, 19.55, 92.10},
{J1809-202, 19.60, 10.00},
{     M17, 19.65, 92.10},
{IR19207+1410, 19.70, 10.00},
{    SgrA, 19.75, 100.00},
{J1809-202, 19.80, 10.00},
{     M17, 19.85, 92.10},
{IR19207+1410, 19.90, 10.00},
{    SgrA, 19.95, 100.00},
{     M17, 20.00, 92.10},
{PMNJ1622, 20.05, 77.30},
{PMNJ1924, 20.10, 10.00},
{IR19207+1410, 20.15, 10.00},
{IR19207+1410, 20.20, 10.00},
{IR19207+1410, 20.25, 10.00},
{IR19207+1410, 20.30, 10.00},
{    SgrA, 20.35, 100.00},
{IR19207+1410, 20.40, 10.00},
{PMNJ1924, 20.45, 10.00},
{J1809-202, 20.50, 10.00},
{PMNJ1924, 20.55, 10.00},
{J1809-202, 20.60, 10.00},
{PMNJ1924, 20.65, 10.00},
{J1809-202, 20.70, 10.00},
{    SgrA, 20.75, 100.00},
{J1809-202, 20.80, 10.00},
{PMNJ1622, 20.85, 77.30},
{PMNJ1924, 20.90, 10.00},
{     M17, 20.95, 92.10},
{IR19207+1410, 21.00, 10.00},
{IR19207+1410, 21.05, 10.00},
{PMNJ1622, 21.10, 77.30},
{IR19207+1410, 21.15, 10.00},
{    SgrA, 21.20, 100.00},
{     M17, 21.25, 92.10},
{PMNJ1924, 21.30, 10.00},
{     M17, 21.35, 92.10},
{PMNJ1622, 21.40, 77.30},
{    SgrA, 21.45, 100.00},
{PMNJ1924, 21.50, 10.00},
{PMNJ1622, 21.55, 77.30},
{IR19207+1410, 21.60, 10.00},
{IR19207+1410, 21.65, 10.00},
{    SgrA, 21.70, 100.00},
{J1809-202, 21.75, 10.00},
{     M17, 21.80, 92.10},
{IR19207+1410, 21.85, 10.00},
{PMNJ1924, 21.90, 10.00},
{IR19207+1410, 21.95, 10.00},
{IR19207+1410, 22.00, 10.00},
{J1809-202, 22.05, 10.00},
{IR19207+1410, 22.10, 10.00},
{PMNJ1924, 22.15, 10.00},
{     M17, 22.20, 92.10},
{PMNJ1924, 22.25, 10.00},
{IR19207+1410, 22.30, 10.00},
{IR19207+1410, 22.35, 10.00},
{J1809-202, 22.40, 10.00},
{PMNJ1924, 22.45, 10.00},
{PMNJ1924, 22.50, 10.00},
{ NGC1316, 22.55, 60.00},
{IR19207+1410, 22.60, 10.00},
{PMNJ1924, 22.65, 10.00},
{     M17, 22.70, 92.10},
{J1809-202, 22.75, 10.00},
{IR19207+1410, 22.80, 10.00},
{ NGC1316, 22.85, 60.00},
{PMNJ1924, 22.90, 10.00},
{     M17, 22.95, 92.10},
{PMNJ1924, 23.00, 10.00},
{ NGC1316, 23.05, 60.00},
{PMNJ1924, 23.10, 10.00},
{PMNJ1924, 23.15, 10.00},
{ NGC1316, 23.20, 60.00},
{PMNJ1924, 23.25, 10.00},
{ NGC1316, 23.30, 60.00},
{ NGC1316, 23.35, 60.00},
{PMNJ1924, 23.40, 10.00},
{PMNJ1924, 23.45, 10.00},
{PMNJ1924, 23.50, 10.00},
{PMNJ1924, 23.55, 10.00},
{ NGC1316, 23.60, 60.00},
{PMNJ1924, 23.65, 10.00},
{ NGC1316, 23.70, 60.00},
{PMNJ1924, 23.75, 10.00},
{PMNJ1924, 23.80, 10.00},
{PMNJ1924, 23.85, 10.00},
{PMNJ1924, 23.90, 10.00},
{PMNJ1924, 23.95, 10.00},
{PMNJ1924, 23.99, 10.00}
}

# start observation
init_obs("Beginning schedule: radio_pointing_south.sch")

# do a sky dip
#do_sky_dip

# do a blank stare for 1.2Hz removal
# start by taking a blank stare
track scpfixed
until $acquired(source)|$elapsed>1m
# Noise!
noise_on_general 5s, 8s
# Blank stare for mains
mark add, f4
until $elapsed>1m
mark remove, f4


# Set archiving to the correct mode
mark remove, all

#-----------------------------------------------------------------------
# Main loop -- track the next source,do a raster, move on
#-----------------------------------------------------------------------

log "LST is currently ",$time(lst)
log "Waiting for lststart... ", $lststart
until $after($lststart,lst)

  # Go through list
  foreach(Source source) $sources {

    # Break if past lststop
    if $time(lst)>$lststop {
       log "lststop reached: ", $lststop
       break
    }

    # Skip sources whose lst has passed
    if $time(lst)>$source.lst  {
       log "too late for source ",$source.name
    }

    # Do a cross on next available source
    if $time(lst)<$source.lst {

      if ($elevation($source.name) >= 27) {
      log "Planning to do a scan on ",$source.name

      # Track Source
      until $after($source.lst,lst) # make sure we're not early
      log "Doing scan on ",$source.name

      # Do scan
      do_point_scan($source.name)


      zeroScanOffsets           # zero offsets

      offset az=5
	  until ($acquired(source) | $elapsed > 1m)
      # Noise!
      noise_on_general 5s, 8s
      offset az=0


    } #elevation requirement
    }
  }

# do a sky dip
#do_sky_dip

terminate("Finished schedule: radio_pointing_south.sch")



