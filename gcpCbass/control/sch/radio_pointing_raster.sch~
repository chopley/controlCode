(Time lststart, Time lststop)
# Cycle through list of radio sources taking a scan on each

import ~cbass/gcpCbass/control/sch/schedlib.sch

# Define source list, with an lst for each one.  This list is
# created by rad_set.m in order to maximize sky coverage.

group Source {
  Source name,    # source name
  Time  lst,      # lst to observe source
  Double flux     # source flux (in Jy)
}


init_obs("Beginning schedule: radio_pointing.sch")

listof Source sources = {
{J0137+331, 0.00, 5.48},
{J0204+152, 0.12, 3.70},
{J2232+117, 0.24, 4.20},
{    CygA, 0.36, 365.00},
{J2123+055, 0.48, 4.50},
{J0530+135, 0.60, 4.30},
{J2218-035, 0.72, 3.70},
{J1829+487, 0.84, 3.00},
{J2136+006, 0.96, 9.90},
{J0319+415, 1.08, 23.30},
{J0521+166, 1.20, 3.78},
{J2052+365, 1.32, 3.00},
{J2232+117, 1.44, 4.20},
{J0542+498, 1.56, 7.94},
{J0237+288, 1.68, 2.30},
{J2007+404, 1.80, 4.50},
{J0339-017, 1.92, 2.82},
{J0303+472, 2.04, 2.47},
{J0738+177, 2.16, 2.20},
{J0410+769, 2.28, 2.79},
{J0834+555, 2.40, 5.60},
{J2253+161, 2.52, 10.00},
{    CasA, 2.64, 670.00},
{J0534+194, 2.76, 2.50},
{J2022+616, 2.88, 2.30},
{J0231+133, 3.00, 2.20},
{J0534+194, 3.12, 2.50},
{J0217+738, 3.24, 2.30},
{J0431+206, 3.36, 2.35},
{J0927+390, 3.48, 7.60},
{J0534+194, 3.60, 2.50},
{J0501-019, 3.72, 2.15},
{J0237+288, 3.84, 2.30},
{J0521+166, 3.96, 3.78},
{J0217+738, 4.08, 2.30},
{J0431+206, 4.20, 2.35},
{J0744-064, 4.32, 3.00},
{J0834+555, 4.44, 5.60},
{J0204+152, 4.56, 3.70},
{J0927+390, 4.68, 7.60},
{J1800+784, 4.80, 2.10},
{J0231+133, 4.92, 2.20},
{J0303+472, 5.04, 2.47},
{J0738+177, 5.16, 2.20},
{J0745+101, 5.28, 3.50},
{J0841+708, 5.40, 2.60},
{J0303+472, 5.52, 2.47},
{J0745+101, 5.64, 3.50},
{J1459+716, 5.76, 2.80},
{J0534+194, 5.88, 2.50},
{J0607-085, 6.00, 2.70},
{    CasA, 6.12, 670.00},
{J0431+206, 6.24, 2.35},
{J0237+288, 6.36, 2.30},
{J0534+194, 6.48, 2.50},
{J0303+472, 6.60, 2.47},
{J0730-116, 6.72, 2.60},
{J0534+194, 6.84, 2.50},
{J0303+472, 6.96, 2.47},
{J0433+053, 7.08, 3.60},
{J0217+738, 7.20, 2.30},
{J0303+472, 7.32, 2.47},
{J0902-142, 7.44, 2.10},
{    TauA, 7.56, 615.00},
{J0927+390, 7.68, 7.60},
{J0303+472, 7.80, 2.47},
{J1411+522, 7.92, 6.50},
{J0501-019, 8.04, 2.15},
{J1927+739, 8.16, 3.00},
{J0318+164, 8.28, 2.95},
{J0738+177, 8.40, 2.20},
{J0555+398, 8.52, 5.00},
{J1331+305, 8.64, 7.47},
{J0730-116, 8.76, 2.60},
{J0854+201, 8.88, 2.30},
{J0501-019, 9.00, 2.15},
{J1927+739, 9.12, 3.00},
{  VirgoA, 9.24, 70.00},
{J1229+020, 9.36, 30.00},
{J1248-199, 9.48, 2.40},
{J1331+305, 9.60, 7.47},
{J0431+206, 9.72, 2.35},
{J1347+122, 9.84, 2.90},
{J1008+075, 9.96, 2.50},
{J1330+251, 10.08, 3.30},
{J0927+390, 10.20, 7.60},
{J1642+398, 10.32, 7.80},
{J1800+784, 10.44, 2.10},
{J0521+166, 10.56, 3.78},
{J1330+251, 10.68, 3.30},
{J1748+700, 10.80, 2.10},
{J0834+555, 10.92, 5.60},
{J1337-129, 11.04, 4.30},
{J1256-057, 11.16, 11.20},
{J0432+416, 11.28, 3.70},
{J0841+708, 11.40, 2.60},
{J1459+716, 11.52, 2.80},
{J0410+769, 11.64, 2.79},
{  VirgoA, 11.76, 70.00},
{J1549+026, 11.88, 2.20},
{J1337-129, 12.00, 4.30},
{J0902-142, 12.12, 2.10},
{J1459+716, 12.24, 2.80},
{J0217+738, 12.36, 2.30},
{J0834+555, 12.48, 5.60},
{J1613+342, 12.60, 2.30},
{J1927+739, 12.72, 3.00},
{J1130-148, 12.84, 4.60},
{J1411+522, 12.96, 6.50},
{J0834+555, 13.08, 5.60},
{J1407+284, 13.20, 2.80},
{J2022+616, 13.32, 2.30},
{J1512-090, 13.44, 3.30},
{J2038+513, 13.56, 3.70},
{J1407+284, 13.68, 2.80},
{J0841+708, 13.80, 2.60},
{J1512-090, 13.92, 3.30},
{J2038+513, 14.04, 3.70},
{J2023+318, 14.16, 2.80},
{J1507-168, 14.28, 2.90},
{J2023+318, 14.40, 2.80},
{J1743-038, 14.52, 2.70},
{J2038+513, 14.64, 3.70},
{    CygA, 14.76, 365.00},
{J0834+555, 14.88, 5.60},
{J1642+398, 15.00, 7.80},
{J1733-130, 15.12, 5.00},
{J2015+371, 15.24, 2.76},
{J1248-199, 15.36, 2.40},
{J2052+365, 15.48, 3.00},
{J1229+020, 15.60, 30.00},
{J2022+616, 15.72, 2.30},
{J2202+422, 15.84, 5.40},
{J2022+616, 15.96, 2.30},
{    CasA, 16.08, 670.00},
{J2022+616, 16.20, 2.30},
{J1330+251, 16.32, 3.30},
{J1407+284, 16.44, 2.80},
{J1642+398, 16.56, 7.80},
{J1743-038, 16.68, 2.70},
{J1635+381, 16.80, 2.20},
{J1829+487, 16.92, 3.00},
{J2038+513, 17.04, 3.70},
{J0217+738, 17.16, 2.30},
{J2148+069, 17.28, 2.50},
{J1330+251, 17.40, 3.30},
{J1941-154, 17.52, 2.20},
{J1829+487, 17.64, 3.00},
{J2052+365, 17.76, 3.00},
{J0410+769, 17.88, 2.79},
{J2123+055, 18.00, 4.50},
{J2038+513, 18.12, 3.70},
{J1635+381, 18.24, 2.20},
{J2022+616, 18.36, 2.30},
{    CygA, 18.48, 365.00},
{J1748+700, 18.60, 2.10},
{J2148+069, 18.72, 2.50},
{J1635+381, 18.84, 2.20},
{J1642+398, 18.96, 7.80},
{J2225-049, 19.08, 3.80},
{J1330+251, 19.20, 3.30},
{J1743-038, 19.32, 2.70},
{J1927+739, 19.44, 3.00},
{J1941-154, 19.56, 2.20},
{    CasA, 19.68, 670.00},
{J0303+472, 19.80, 2.47},
{J2052+365, 19.92, 3.00},
{J2025+337, 20.04, 2.80},
{J1411+522, 20.16, 6.50},
{J0137+331, 20.28, 5.48},
{J2246-121, 20.40, 2.80},
{J0237+288, 20.52, 2.30},
{J1941-154, 20.64, 2.20},
{J1743-038, 20.76, 2.70},
{J2038+513, 20.88, 3.70},
{J2130+050, 21.00, 2.10},
{J2218-035, 21.12, 3.70},
{J1642+398, 21.24, 7.80},
{J1635+381, 21.36, 2.20},
{J0841+708, 21.48, 2.60},
{J0359+509, 21.60, 10.10},
{J0237+288, 21.72, 2.30},
{J2007+404, 21.84, 4.50},
{J2134-018, 21.96, 2.70},
{J0137+331, 22.08, 5.48},
{J1613+342, 22.20, 2.30},
{J2225-049, 22.32, 3.80},
{J1927+739, 22.44, 3.00},
{J1459+716, 22.56, 2.80},
{J2025+337, 22.68, 2.80},
{J2130+050, 22.80, 2.10},
{J0410+769, 22.92, 2.79},
{J0542+498, 23.04, 7.94},
{J1459+716, 23.16, 2.80},
{J2015+371, 23.28, 2.76},
{J2202+422, 23.40, 5.40},
{J1800+784, 23.52, 2.10},
{J1927+739, 23.64, 3.00},
{J0410+769, 23.76, 2.79},
{    CygA, 23.88, 365.00}
}

# Set archiving to the correct mode
mark remove, all

#-----------------------------------------------------------------------
# Main loop -- track the next source,do a raster, move on
#-----------------------------------------------------------------------

log "Waiting for lststart..."
until $after($lststart,lst) 

  # Go through list
  foreach(Source source) $sources {

    # Break if past lststop
    if $time(lst)>$lststop {
       log "lststop reached"
       break
    }   

    # Skip sources whose lst has passed
    if $time(lst)>$source.lst  {
       log "too late for source",$source.name
    }

    # Do a cross on next available source
    if $time(lst)<$source.lst {
      # Track Source
      track $source.name
      until $acquired(source)
      until $after($source.lst,lst) # make sure we're not early
      log "Doing scan on ",$source.name

      # Do scan
      scan point_10d_0.5step
      #until $acquired(scan)
      until $elapsed >7m

      zeroScanOffsets   	# zero offsets
    }
  }

terminate("Finished schedule: radio_pointing_raster.sch")

